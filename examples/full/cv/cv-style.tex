% packages, etc.
\usepackage[final]{pdfpages}
\usepackage[hang,flushmargin]{footmisc}
\usepackage{multicol,xpatch,xhfill,booktabs,multirow,caption,float,enumitem}
\moderncvcolor{blue}
\usepackage[scale=0.8,margin=1.4cm,tmargin=2.0cm,bmargin=2.2cm]{geometry}
% full vs default width
\newcommand{\initwidths}{
  \newlength{\colhintwid}\setlength{\colhintwid}{\hintscolumnwidth}
  \newlength{\colmainwid}\setlength{\colmainwid}{\maincolumnwidth}
  \newlength{\colsepwid}\setlength{\colsepwid}{\separatorcolumnwidth}}
\newcommand{\fullwidth}{
  \setlength{\hintscolumnwidth}{0pt}
  \setlength{\maincolumnwidth}{\textwidth}
  \setlength{\separatorcolumnwidth}{0pt}}
\newcommand{\defaultwidth}{
  \setlength{\hintscolumnwidth}{\colhintwid}
  \setlength{\maincolumnwidth}{\colmainwid}
  \setlength{\separatorcolumnwidth}{\colsepwid}}
% formatting commands
\setlength{\hintscolumnwidth}{2.6cm}
\renewcommand{\hintfont}{\small}
\newcommand{\dates}[1]{\small{#1}}
\newcommand{\cvitemdate}[3]{\cvitemwithcomment{#1}{#2}{\dates{\normalfont{#3}}}}
\newcommand{\cvitemdatein}[2]{\cvitem{}{%
  \begin{tabular}{>{}m{\hintscolumnwidth}c}{#1}&\hspace{\separatorcolumnwidth}{#2}\end{tabular}}}
\newcommand{\cvlistitemdate}[2]{\cvlistitem{#1\hfill#2}}
\newcommand{\df}{\hfill--\hfill}
\newcommand{\emailto}[1]{\href{mailto:#1}{\texttt{#1}}}
\newcommand{\pt}{\textsuperscript{\dag}}
\definecolor{link}{rgb}{0.6 0.1 0.1}
\newcommand{\hrefc}[2]{\href{#1}{\color{link}{#2}}}
\newcommand{\hreftt}[1]{\href{#1}{\scriptsize\texttt{\color{link}{\url{#1}}}}}
\renewcommand\UrlFont{\color{link}\ttfamily}
\renewcommand*{\namefont}{\fontsize{20}{0}\mdseries\upshape}
\renewcommand*{\addressfont}{\small\mdseries}
\newenvironment{listsmall}{\small}{}
\newcommand{\matlab}{\textsc{matlab}}
\newcommand{\mainsection}[1]{\defaultwidth\section{{\color{black}\large\textbf{#1}}}\fullwidth}
\newcommand{\floatskip}{\\[12pt]}
\setlist[enumerate]{parsep=0pt,leftmargin=18pt,topsep=0pt,itemsep=3pt}
\clubpenalty=10000
\widowpenalty=10000
\displaywidowpenalty=10000